"use strict";var MChain=MChain||function(){function e(e,n){this.chain=[],n>=1||(n=1);for(var r=0;r<n;r++)e.unshift("_");for(var r=0;r<e.length-n+2;r++){var i=[];for(var s=r;s<r+n+1;s++)i.push(e[s]);var o=i[i.length-1];i.pop();var u=i.join(),a=!0;for(var s=0;s<this.chain.length;s++)if(this.chain[s].state===u){this.chain[s].neighbors.add(o),a=!1;break}if(a){var f=new t([o]);this.chain.push({state:u,neighbors:f})}}this.currentState=this.chain[Math.floor(Math.random()*this.chain.length)].state}function t(e){this.list=[],this.sum=0;if(e)for(var t=0;t<e.length;t++)this.add(e[t])}return e.prototype.choose=function(){for(var e=0;e<this.chain.length;e++)if(this.chain[e].state===this.currentState){var t=this.chain[e].neighbors.choose(),n={state:this.chain[e].state,neighbors:this.chain[e].neighbors,chosen_neighbor:t},r=this.currentState.split(",");return r.shift(),r.push(t.event),this.currentState=r.join(),n}return this.currentState=this.chain[Math.floor(Math.random()*this.chain.length)].state,this.choose()},t.prototype.updateSum=function(){this.sum=0;for(var e=0;e<this.list.length;e++)this.sum+=this.list[e].count},t.prototype.normalize=function(){this.updateSum();for(var e=0;e<this.list.length;e++)this.list[e].relative_frequency=this.list[e].count/this.sum},t.prototype.add=function(e){for(var t=0;t<this.list.length;t++)if(e===this.list[t].event){this.list[t].count+=1,this.normalize();return}this.list.push({event:e,count:1}),this.normalize()},t.prototype.choose=function(){var e=0,t=Math.random();for(var n=0;n<this.list.length;n++){e+=this.list[n].relative_frequency;if(t<e)return this.list[n]}},{create:function(t,n){return new e(t,n)}}}()